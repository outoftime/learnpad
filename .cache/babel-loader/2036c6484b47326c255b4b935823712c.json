{
  "ast": null,
  "code": "function _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nimport clone from 'lodash-es/clone';\nimport defaults from 'lodash-es/defaults';\nimport { Linter, rules } from 'htmllint';\nimport reduce from 'lodash-es/reduce';\nimport Validator from '../Validator';\nvar errorMap = {\n  E001: function E001(error) {\n    switch (error.data.attribute.toLowerCase()) {\n      case 'align':\n        return {\n          reason: 'banned-attributes.align'\n        };\n\n      case 'background':\n        return {\n          reason: 'banned-attributes.background'\n        };\n\n      case 'bgcolor':\n        return {\n          reason: 'banned-attributes.bgcolor'\n        };\n\n      case 'border':\n      case 'frameborder':\n        return {\n          reason: 'banned-attributes.frameborder',\n          payload: {\n            attribute: error.data.attribute\n          }\n        };\n\n      case 'marginwidth':\n        return {\n          reason: 'banned-attributes.marginwidth'\n        };\n\n      case 'marginheight':\n        return {\n          reason: 'banned-attributes.marginheight'\n        };\n\n      case 'scrolling':\n        return {\n          reason: 'banned-attributes.scrolling'\n        };\n\n      case 'width':\n        return {\n          reason: 'banned-attributes.width'\n        };\n    }\n\n    return null;\n  },\n  E002: function E002() {\n    return {\n      reason: 'lower-case-attribute-name'\n    };\n  },\n  E005: function E005(error) {\n    return {\n      reason: 'attribute-quotes',\n      payload: {\n        attribute: error.data.attribute\n      }\n    };\n  },\n  E006: function E006() {\n    return {\n      reason: 'attribute-value'\n    };\n  },\n  E007: function E007() {\n    return {\n      reason: 'doctype',\n      suppresses: ['invalid-tag-name']\n    };\n  },\n  E008: function E008() {\n    return {\n      reason: 'doctype'\n    };\n  },\n  E009: function E009() {\n    return {\n      reason: 'href-style'\n    };\n  },\n  E012: function E012(error) {\n    return {\n      reason: 'duplicated-id',\n      payload: {\n        id: error.data.id\n      }\n    };\n  },\n  E014: function E014() {\n    return {\n      reason: 'img-src'\n    };\n  },\n  E016: function E016(error) {\n    return {\n      reason: \"deprecated-tag.\".concat(error.data.tag.toLowerCase())\n    };\n  },\n  E017: function E017() {\n    return {\n      reason: 'lower-case-tag-name'\n    };\n  },\n  E018: function E018(error, source) {\n    var lines = source.split('\\n');\n    var tagNameExpr = /((?:[\\0-\\t\\x0B\\f\\x0E-\\u2027\\u202A-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])*?)[\\t-\\r \\xA0\\u1680\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\uFEFF]*\\/>/;\n\n    var _tagNameExpr$exec = tagNameExpr.exec(lines[error.line - 1].slice(error.column)),\n        _tagNameExpr$exec2 = _slicedToArray(_tagNameExpr$exec, 2),\n        tag = _tagNameExpr$exec2[1];\n\n    return {\n      reason: 'self-closing-tag',\n      payload: {\n        tag: tag\n      }\n    };\n  },\n  E027: function E027() {\n    return {\n      reason: 'missing-title'\n    };\n  },\n  E028: function E028() {\n    return {\n      reason: 'duplicated-title'\n    };\n  },\n  E041: function E041(_ref) {\n    var classes = _ref.data.classes;\n    return {\n      reason: 'duplicated-class',\n      payload: {\n        classes: classes\n      }\n    };\n  },\n  E042: function E042(error, source) {\n    var lines = source.split('\\n');\n    var tagNameExpr = /(?:[\\0-\\x08\\x0E-\\x1F!-=\\?-\\x9F\\xA1-\\u167F\\u1681-\\u1FFF\\u200B-\\u2027\\u202A-\\u202E\\u2030-\\u205E\\u2060-\\u2FFF\\u3001-\\uD7FF\\uE000-\\uFEFE\\uFF00-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])+/;\n\n    var _tagNameExpr$exec3 = tagNameExpr.exec(lines[error.line - 1].slice(error.column)),\n        _tagNameExpr$exec4 = _slicedToArray(_tagNameExpr$exec3, 1),\n        tag = _tagNameExpr$exec4[0];\n\n    return {\n      reason: 'unclosed-tag',\n      payload: {\n        tag: tag\n      }\n    };\n  },\n  E044: function E044() {\n    return {\n      reason: 'only-head-body-in-html'\n    };\n  },\n  E045: function E045() {\n    return {\n      reason: 'only-one-head-and-body'\n    };\n  },\n  E046: function E046() {\n    return {\n      reason: 'head-before-body'\n    };\n  },\n  E047: function E047() {\n    return {\n      reason: 'invalid-tag-in-head'\n    };\n  }\n};\nvar htmlLintOptions = {\n  'attr-bans': ['align', 'background', 'bgcolor', 'border', 'frameborder', 'marginwidth', 'marginheight', 'scrolling', 'width'],\n  'attr-name-style': 'dash',\n  'attr-no-dup': true,\n  'attr-quote-style': 'quoted',\n  'attr-req-value': true,\n  'class-no-dup': true,\n  'doctype-first': true,\n  'doctype-html5': true,\n  'head-req-title': true,\n  'head-valid-content-model': true,\n  'html-valid-content-model': true,\n  'id-no-dup': true,\n  'img-req-src': true,\n  'tag-bans': ['b', 'big', 'center', 'font', 'i', 'tt', 'strike'],\n  'tag-name-match': true,\n  'tag-name-lowercase': true,\n  'tag-self-close': 'never',\n  'title-no-dup': true,\n  'href-style': 'absolute'\n};\nvar linter = new Linter(rules);\nvar options = reduce(linter.rules.options, function (acc, _ref2) {\n  var name = _ref2.name;\n  return defaults(acc, _defineProperty({}, name, false));\n}, clone(htmlLintOptions));\n\nvar HtmllintValidator =\n/*#__PURE__*/\nfunction (_Validator) {\n  _inherits(HtmllintValidator, _Validator);\n\n  function HtmllintValidator(source) {\n    _classCallCheck(this, HtmllintValidator);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(HtmllintValidator).call(this, source, 'html', errorMap));\n  }\n\n  _createClass(HtmllintValidator, [{\n    key: \"getRawErrors\",\n    value: function () {\n      var _getRawErrors = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var results;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return linter.lint(this.source, options);\n\n              case 3:\n                results = _context.sent;\n                return _context.abrupt(\"return\", results);\n\n              case 7:\n                _context.prev = 7;\n                _context.t0 = _context[\"catch\"](0);\n                return _context.abrupt(\"return\", []);\n\n              case 10:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 7]]);\n      }));\n\n      function getRawErrors() {\n        return _getRawErrors.apply(this, arguments);\n      }\n\n      return getRawErrors;\n    }()\n  }, {\n    key: \"keyForError\",\n    value: function keyForError(error) {\n      return error.code;\n    }\n  }, {\n    key: \"locationForError\",\n    value: function locationForError(error) {\n      var row = error.line - 1;\n      var column = error.column - 1;\n      return {\n        row: row,\n        column: column\n      };\n    }\n  }]);\n\n  return HtmllintValidator;\n}(Validator);\n\nexport default (function (source) {\n  return new HtmllintValidator(source).getAnnotations();\n});",
  "map": {
    "version": 3,
    "sources": [
      "/Users/peter/Desktop/code/popcode/src/validations/html/htmllint.js"
    ],
    "names": [
      "clone",
      "defaults",
      "Linter",
      "rules",
      "reduce",
      "Validator",
      "errorMap",
      "E001",
      "error",
      "data",
      "attribute",
      "toLowerCase",
      "reason",
      "payload",
      "E002",
      "E005",
      "E006",
      "E007",
      "suppresses",
      "E008",
      "E009",
      "E012",
      "id",
      "E014",
      "E016",
      "tag",
      "E017",
      "E018",
      "source",
      "lines",
      "split",
      "tagNameExpr",
      "exec",
      "line",
      "slice",
      "column",
      "E027",
      "E028",
      "E041",
      "classes",
      "E042",
      "E044",
      "E045",
      "E046",
      "E047",
      "htmlLintOptions",
      "linter",
      "options",
      "acc",
      "name",
      "HtmllintValidator",
      "lint",
      "results",
      "code",
      "row",
      "getAnnotations"
    ],
    "mappings": "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",
    "sourcesContent": [
      "import clone from 'lodash-es/clone';\nimport defaults from 'lodash-es/defaults';\nimport {Linter, rules} from 'htmllint';\nimport reduce from 'lodash-es/reduce';\n\nimport Validator from '../Validator';\n\nconst errorMap = {\n  E001: error => {\n    switch (error.data.attribute.toLowerCase()) {\n      case 'align':\n        return {reason: 'banned-attributes.align'};\n      case 'background':\n        return {reason: 'banned-attributes.background'};\n      case 'bgcolor':\n        return {reason: 'banned-attributes.bgcolor'};\n      case 'border':\n      case 'frameborder':\n        return {\n          reason: 'banned-attributes.frameborder',\n          payload: {attribute: error.data.attribute},\n        };\n      case 'marginwidth':\n        return {reason: 'banned-attributes.marginwidth'};\n      case 'marginheight':\n        return {reason: 'banned-attributes.marginheight'};\n      case 'scrolling':\n        return {reason: 'banned-attributes.scrolling'};\n      case 'width':\n        return {reason: 'banned-attributes.width'};\n    }\n\n    return null;\n  },\n\n  E002: () => ({reason: 'lower-case-attribute-name'}),\n\n  E005: error => ({\n    reason: 'attribute-quotes',\n    payload: {attribute: error.data.attribute},\n  }),\n\n  E006: () => ({reason: 'attribute-value'}),\n\n  E007: () => ({reason: 'doctype', suppresses: ['invalid-tag-name']}),\n\n  E008: () => ({reason: 'doctype'}),\n\n  E009: () => ({reason: 'href-style'}),\n\n  E012: error => ({reason: 'duplicated-id', payload: {id: error.data.id}}),\n\n  E014: () => ({reason: 'img-src'}),\n\n  E016: error => ({\n    reason: `deprecated-tag.${error.data.tag.toLowerCase()}`,\n  }),\n\n  E017: () => ({reason: 'lower-case-tag-name'}),\n\n  E018: (error, source) => {\n    const lines = source.split('\\n');\n    const tagNameExpr = /(.*?)\\s*\\/>/u;\n    const [, tag] = tagNameExpr.exec(lines[error.line - 1].slice(error.column));\n\n    return {\n      reason: 'self-closing-tag',\n      payload: {tag},\n    };\n  },\n\n  E027: () => ({reason: 'missing-title'}),\n\n  E028: () => ({reason: 'duplicated-title'}),\n\n  E041: ({data: {classes}}) => ({\n    reason: 'duplicated-class',\n    payload: {classes},\n  }),\n\n  E042: (error, source) => {\n    const lines = source.split('\\n');\n    const tagNameExpr = /[^\\s>]+/u;\n    const [tag] = tagNameExpr.exec(lines[error.line - 1].slice(error.column));\n\n    return {\n      reason: 'unclosed-tag',\n      payload: {tag},\n    };\n  },\n\n  E044: () => ({reason: 'only-head-body-in-html'}),\n\n  E045: () => ({reason: 'only-one-head-and-body'}),\n\n  E046: () => ({reason: 'head-before-body'}),\n\n  E047: () => ({reason: 'invalid-tag-in-head'}),\n};\n\nconst htmlLintOptions = {\n  'attr-bans': [\n    'align',\n    'background',\n    'bgcolor',\n    'border',\n    'frameborder',\n    'marginwidth',\n    'marginheight',\n    'scrolling',\n    'width',\n  ],\n  'attr-name-style': 'dash',\n  'attr-no-dup': true,\n  'attr-quote-style': 'quoted',\n  'attr-req-value': true,\n  'class-no-dup': true,\n  'doctype-first': true,\n  'doctype-html5': true,\n  'head-req-title': true,\n  'head-valid-content-model': true,\n  'html-valid-content-model': true,\n  'id-no-dup': true,\n  'img-req-src': true,\n  'tag-bans': ['b', 'big', 'center', 'font', 'i', 'tt', 'strike'],\n  'tag-name-match': true,\n  'tag-name-lowercase': true,\n  'tag-self-close': 'never',\n  'title-no-dup': true,\n  'href-style': 'absolute',\n};\n\nconst linter = new Linter(rules);\nconst options = reduce(\n  linter.rules.options,\n  (acc, {name}) => defaults(acc, {[name]: false}),\n  clone(htmlLintOptions),\n);\n\nclass HtmllintValidator extends Validator {\n  constructor(source) {\n    super(source, 'html', errorMap);\n  }\n\n  async getRawErrors() {\n    try {\n      const results = await linter.lint(this.source, options);\n      return results;\n    } catch (e) {\n      return [];\n    }\n  }\n\n  keyForError(error) {\n    return error.code;\n  }\n\n  locationForError(error) {\n    const row = error.line - 1;\n    const column = error.column - 1;\n    return {row, column};\n  }\n}\n\nexport default source => new HtmllintValidator(source).getAnnotations();\n"
    ]
  },
  "metadata": {},
  "sourceType": "module"
}
